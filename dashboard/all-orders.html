<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Orders - Emily Bakes Cakes</title>
    <link rel="stylesheet" href="css/dashboard-redesigned.css">
    <style>
        .filters-bar {
            background: var(--bg-white);
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .filter-group label {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-group select,
        .filter-group input {
            padding: 8px 12px;
            border: 1px solid var(--border-light);
            border-radius: 6px;
            font-size: 13px;
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(196, 69, 105, 0.1);
        }

        .orders-table-container {
            background: var(--bg-white);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
        }

        .orders-table {
            width: 100%;
            border-collapse: collapse;
        }

        .orders-table thead {
            background: var(--bg-light);
            border-bottom: 2px solid var(--border-light);
        }

        .orders-table th {
            padding: 12px 14px;
            text-align: left;
            font-weight: 600;
            font-size: 11px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .orders-table tbody tr {
            border-bottom: 1px solid var(--border-light);
            transition: var(--transition-fast);
        }

        .orders-table tbody tr:hover {
            background: var(--bg-light);
        }

        .orders-table td {
            padding: 12px 14px;
            font-size: 13px;
            color: var(--text-primary);
        }

        .order-id {
            font-weight: 600;
            color: var(--primary);
        }

        .customer-name {
            font-weight: 500;
        }

        .order-date {
            color: var(--text-secondary);
        }

        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-pending {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .status-confirmed {
            background: rgba(59, 130, 246, 0.1);
            color: var(--info);
        }

        .status-completed {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .status-cancelled {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .amount {
            font-weight: 600;
            color: var(--primary);
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .btn-sm {
            padding: 6px 10px;
            border: none;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-fast);
            text-decoration: none;
            display: inline-block;
        }

        .btn-view {
            background: var(--info);
            color: white;
        }

        .btn-view:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

        .btn-edit {
            background: var(--primary);
            color: white;
        }

        .btn-edit:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .btn-delete {
            background: var(--danger);
            color: white;
        }

        .btn-delete:hover {
            background: #dc2626;
            transform: translateY(-1px);
        }

        .empty-state {
            padding: 60px 20px;
            text-align: center;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 20px;
            padding: 16px;
        }

        .pagination button,
        .pagination a {
            padding: 8px 12px;
            border: 1px solid var(--border-light);
            border-radius: 6px;
            background: var(--bg-white);
            cursor: pointer;
            font-size: 12px;
            transition: var(--transition-fast);
        }

        .pagination button:hover,
        .pagination a:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .pagination .active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-white);
            border-radius: 8px;
            padding: 32px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 25px rgba(0, 0, 0, 0.15);
        }

        .modal-header {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            font-size: 12px;
            color: var(--text-primary);
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-light);
            border-radius: 6px;
            font-size: 13px;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(196, 69, 105, 0.1);
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .modal-actions button {
            flex: 1;
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--border-light);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--border-dark);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--bg-white);
            padding: 16px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--border-light);
            box-shadow: var(--shadow-sm);
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 11px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        @media (max-width: 768px) {
            .filters-bar {
                grid-template-columns: 1fr;
            }

            .orders-table {
                font-size: 11px;
            }

            .orders-table th,
            .orders-table td {
                padding: 8px 10px;
            }

            .action-buttons {
                flex-direction: column;
            }

            .btn-sm {
                width: 100%;
            }

            .modal-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <header class="header">
        <div class="header-left">
            <div class="header-logo">
                <div class="logo-text">Emily Bakes Cakes</div>
            </div>
        </div>
        <div class="header-right">
            <button class="header-btn" onclick="backToSite()">‚Üê Back to Site</button>
            <button class="logout-btn header-btn" onclick="handleLogout()">Logout</button>
        </div>
    </header>

    <!-- LEFT NAVIGATION -->
    <nav class="nav-sidebar">
        <ul>
            <li><a href="#" onclick="goToDashboard(); return false;" class="nav-link">Dashboard</a></li>
            <li><a href="all-orders.html" class="nav-link active">View Orders</a></li>
            <li><a href="all-customers.html" class="nav-link">View Customers</a></li>
            <li><a href="view-products.html" class="nav-link">View Products</a></li>
            <li><a href="reports.html" class="nav-link">Reports</a></li>
        </ul>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="main-content">
        <div class="content">
            <!-- PAGE HEADER -->
            <div class="page-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                <div>
                    <h1 class="page-title">All Orders</h1>
                    <p class="page-subtitle">Manage and track all customer orders</p>
                </div>
                <a href="../order-form-wizard.html" class="action-btn-large" style="text-decoration: none;">+ Create New Order</a>
            </div>

            <!-- FILTERS -->
            <div class="filters-bar">
                <div class="filter-group">
                    <label>Search by Order ID or Customer</label>
                    <input type="text" id="searchInput" placeholder="Search...">
                </div>
                <div class="filter-group">
                    <label>Status</label>
                    <select id="statusFilter">
                        <option value="">All Statuses</option>
                        <option value="pending">Pending</option>
                        <option value="confirmed">Confirmed</option>
                        <option value="completed">Completed</option>
                        <option value="cancelled">Cancelled</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Date Range</label>
                    <input type="date" id="dateFilter">
                </div>
                <div class="filter-group" style="align-self: flex-end;">
                    <button class="action-btn-primary" onclick="resetFilters()">Reset Filters</button>
                </div>
            </div>

            <!-- ORDERS TABLE -->
            <div class="orders-table-container">
                <table class="orders-table" id="ordersTable">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Customer</th>
                            <th>Order Date</th>
                            <th>Pickup Date</th>
                            <th>Amount</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="ordersTableBody">
                        <tr>
                            <td colspan="7" class="empty-state">
                                <div class="empty-state-icon">üì¶</div>
                                <p>No orders found</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <!-- EDIT ORDER MODAL -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- VIEW ORDER MODAL (Read-Only) -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="viewOrderModal" class="modal-overlay">
        <div class="modal-container modal-large">
            <div class="modal-header">
                <h2 class="modal-title">Order Details - #<span id="viewOrderId"></span></h2>
                <button class="modal-close-btn" onclick="closeModal('viewOrderModal')" aria-label="Close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div id="viewOrderBody" class="order-details-grid">
                    <!-- Dynamically populated -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('viewOrderModal')">Close</button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- EDIT ORDER MODAL (Editable Form) -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="editOrderModal" class="modal-overlay">
        <div class="modal-container modal-large">
            <div class="modal-header">
                <h2 class="modal-title">Edit Order - #<span id="editOrderId"></span></h2>
                <button class="modal-close-btn" onclick="closeModal('editOrderModal')" aria-label="Close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <form id="editOrderForm" onsubmit="saveOrderEdits(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="editCustomerId">Customer *</label>
                            <select id="editCustomerId" name="customerId" required class="form-control">
                                <!-- Populated dynamically -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="editProductId">Product *</label>
                            <select id="editProductId" name="productId" required class="form-control">
                                <!-- Populated dynamically -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="editPickupDate">Pickup Date *</label>
                            <input type="date" id="editPickupDate" name="pickupDate" required class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="editPickupTime">Pickup Time *</label>
                            <input type="time" id="editPickupTime" name="pickupTime" required class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="editTotalPrice">Total Price ($) *</label>
                            <input type="number" id="editTotalPrice" name="totalPrice" min="0" step="0.01" required class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="editDepositAmount">Deposit Amount ($) *</label>
                            <input type="number" id="editDepositAmount" name="depositAmount" min="0" step="0.01" required class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="editStatusId">Status *</label>
                            <select id="editStatusId" name="statusId" required class="form-control">
                                <option value="1">To Be Created</option>
                                <option value="2">In Baking</option>
                                <option value="3">Decorating</option>
                                <option value="4">Ready for Pickup</option>
                                <option value="5">Picked Up</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="editPaymentMethod">Payment Method *</label>
                            <select id="editPaymentMethod" name="paymentMethod" required class="form-control">
                                <option value="Cash">Cash</option>
                                <option value="Debit">Debit Card</option>
                                <option value="Visa">Visa</option>
                                <option value="MasterCard">MasterCard</option>
                                <option value="AmEx">American Express</option>
                            </select>
                        </div>
                        <div class="form-group full-width">
                            <label for="editNotes">Notes</label>
                            <textarea id="editNotes" name="notes" rows="3" class="form-control"></textarea>
                        </div>
                        <div class="form-group full-width">
                            <label for="editDecorationNotes">Decoration Notes</label>
                            <textarea id="editDecorationNotes" name="decorationNotes" rows="2" class="form-control"></textarea>
                        </div>
                    </div>
                    <input type="hidden" id="editOrderIdHidden" name="orderId">
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeModal('editOrderModal')">Cancel</button>
                <button type="button" class="btn-primary" onclick="document.getElementById('editOrderForm').requestSubmit()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- MARK ORDER INACTIVE MODAL (Confirmation) -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="inactiveOrderModal" class="modal-overlay">
        <div class="modal-container modal-small">
            <div class="modal-header">
                <h2 class="modal-title">Cancel Order?</h2>
                <button class="modal-close-btn" onclick="closeModal('inactiveOrderModal')" aria-label="Close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="warning-banner">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                        <line x1="12" y1="9" x2="12" y2="13"></line>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg>
                    <div>
                        <p class="warning-title">Are you sure you want to cancel Order #<strong id="inactiveOrderId"></strong>?</p>
                        <p class="warning-subtitle">This action will mark the order as cancelled.</p>
                    </div>
                </div>
                <div class="info-box">
                    <h4>What happens when you cancel:</h4>
                    <ul>
                        <li>Order status changes to "Cancelled"</li>
                        <li>Order remains in system for records</li>
                        <li>Can be reactivated by editing the order</li>
                        <li>Deposit may need refunding per policy</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('inactiveOrderModal')">No, Keep Order</button>
                <button class="btn-warning" onclick="confirmMarkOrderInactive()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="15" y1="9" x2="9" y2="15"></line>
                        <line x1="9" y1="9" x2="15" y2="15"></line>
                    </svg>
                    Yes, Cancel Order
                </button>
            </div>
        </div>
    </div>

    <script src="js/main.js"></script>
    <script src="js/unified-mock-data.js"></script>
    <script>
        // Load all orders from unified mock data
        let allOrders = unifiedMockData.orders.map(order => {
            const customer = unifiedMockData.customers.find(c => c.id === order.customerId);
            const product = unifiedMockData.products.find(p => p.id === order.productId);
            const status = unifiedMockData.orderStatuses.find(s => s.id === order.statusId);
            
            let statusText = 'pending';
            if (order.statusId === 1) statusText = 'pending';
            else if (order.statusId === 2) statusText = 'in-progress';
            else if (order.statusId === 3) statusText = 'in-progress';
            else if (order.statusId === 4) statusText = 'confirmed';
            else if (order.statusId === 5) statusText = 'completed';
            
            return {
                id: order.id,
                customer: customer ? (customer.companyName || `${customer.firstName} ${customer.lastName}`) : 'Unknown',
                phone: customer ? (customer.phone || customer.mobilePhone) : '',
                date: order.orderDate,
                pickupDate: order.pickupDate,
                amount: order.totalPrice,
                status: statusText,
                statusDescription: status ? status.description : 'Unknown',
                cake: product ? product.name : 'Unknown Product',
                notes: order.notes || ''
            };
        });

        let filteredOrders = [...allOrders];
        let currentEditOrder = null;

        function initializePage() {
            loadOrders();
        }

        function loadOrders() {
            const tbody = document.getElementById('ordersTableBody');
            
            if (filteredOrders.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="empty-state"><div class="empty-state-icon">üì¶</div><p>No orders found</p></td></tr>';
                return;
            }

            tbody.innerHTML = filteredOrders.map(order => `
                <tr>
                    <td class="order-id">${order.id}</td>
                    <td class="customer-name">${order.customer}</td>
                    <td class="order-date">${new Date(order.date).toLocaleDateString()}</td>
                    <td class="order-date">${new Date(order.pickupDate).toLocaleDateString()}</td>
                    <td class="amount">$${order.amount.toFixed(2)}</td>
                    <td><span class="status-badge status-${order.status}">${order.status}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-action btn-view" onclick="viewOrder(${order.id})" title="View Details">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                                View
                            </button>
                            <button class="btn-action btn-edit" onclick="editOrder(${order.id})" title="Edit Order">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                </svg>
                                Edit
                            </button>
                            <button class="btn-action btn-inactive" onclick="markOrderInactive(${order.id})" title="Cancel Order">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="15" y1="9" x2="9" y2="15"></line>
                                    <line x1="9" y1="9" x2="15" y2="15"></line>
                                </svg>
                                Cancel
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }


        function filterOrders() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            const status = document.getElementById('statusFilter').value;
            const date = document.getElementById('dateFilter').value;

            filteredOrders = allOrders.filter(order => {
                const matchesSearch = order.id.toLowerCase().includes(search) || 
                                     order.customer.toLowerCase().includes(search);
                const matchesStatus = !status || order.status === status;
                const matchesDate = !date || order.pickupDate === date;

                return matchesSearch && matchesStatus && matchesDate;
            });

            loadOrders();
        }

        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('statusFilter').value = '';
            document.getElementById('dateFilter').value = '';
            filteredOrders = [...allOrders];
            loadOrders();
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // CRUD OPERATIONS FOR ORDERS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        let currentOrderId = null;

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // VIEW ORDER (Read-Only Display)
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function viewOrder(orderId) {
            const order = unifiedMockData.orders.find(o => o.id === orderId);
            if (!order) {
                showNotification('Order not found', 'error');
                return;
            }
            
            const customer = unifiedMockData.getCustomer(order.customerId);
            const product = unifiedMockData.getProduct(order.productId);
            const status = unifiedMockData.getStatusDescription(order.statusId);
            
            document.getElementById('viewOrderId').textContent = order.id;
            document.getElementById('viewOrderBody').innerHTML = `
                <div class="detail-card">
                    <h3 class="detail-card-title">Customer Information</h3>
                    <div class="detail-row">
                        <span class="detail-label">Name:</span>
                        <span class="detail-value">${customer.firstName} ${customer.lastName}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Email:</span>
                        <span class="detail-value">${customer.email || 'N/A'}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Phone:</span>
                        <span class="detail-value">${customer.mobilePhone}</span>
                    </div>
                </div>
                
                <div class="detail-card">
                    <h3 class="detail-card-title">Order Information</h3>
                    <div class="detail-row">
                        <span class="detail-label">Product:</span>
                        <span class="detail-value">${product.name}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Cake Size:</span>
                        <span class="detail-value">${order.cakeSize}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Order Date:</span>
                        <span class="detail-value">${formatDate(order.orderDate)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Pickup Date:</span>
                        <span class="detail-value">${formatDate(order.pickupDate)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Pickup Time:</span>
                        <span class="detail-value">${formatTime(order.pickupTime)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Status:</span>
                        <span class="status-badge status-${getStatusClass(order.statusId)}">${status}</span>
                    </div>
                </div>
                
                <div class="detail-card">
                    <h3 class="detail-card-title">Pricing</h3>
                    <div class="detail-row">
                        <span class="detail-label">Total Price:</span>
                        <span class="detail-value">$${order.totalPrice.toFixed(2)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Deposit Paid:</span>
                        <span class="detail-value">$${order.depositAmount.toFixed(2)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Balance Due:</span>
                        <span class="detail-value balance-due">$${(order.totalPrice - order.depositAmount).toFixed(2)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Payment Method:</span>
                        <span class="detail-value">${order.paymentMethod}</span>
                    </div>
                </div>
                
                ${order.notes || order.decorationNotes ? `
                <div class="detail-card full-width">
                    <h3 class="detail-card-title">Notes</h3>
                    ${order.notes ? `<p class="detail-notes"><strong>Order Notes:</strong> ${order.notes}</p>` : ''}
                    ${order.decorationNotes ? `<p class="detail-notes"><strong>Decoration Notes:</strong> ${order.decorationNotes}</p>` : ''}
                </div>
                ` : ''}
            `;
            
            openModal('viewOrderModal');
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // EDIT ORDER (Populate Form)
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function editOrder(orderId) {
            const order = unifiedMockData.orders.find(o => o.id === orderId);
            if (!order) {
                showNotification('Order not found', 'error');
                return;
            }
            
            currentOrderId = orderId;
            
            // Populate customer dropdown
            const customerSelect = document.getElementById('editCustomerId');
            customerSelect.innerHTML = unifiedMockData.customers
                .map(c => `<option value="${c.id}" ${c.id === order.customerId ? 'selected' : ''}>
                    ${c.firstName} ${c.lastName}${c.companyName ? ' (' + c.companyName + ')' : ''}
                </option>`)
                .join('');
            
            // Populate product dropdown
            const productSelect = document.getElementById('editProductId');
            productSelect.innerHTML = unifiedMockData.products
                .map(p => `<option value="${p.id}" ${p.id === order.productId ? 'selected' : ''}>
                    ${p.name} - $${p.basePrice.toFixed(2)}
                </option>`)
                .join('');
            
            // Populate form fields
            document.getElementById('editOrderId').textContent = order.id;
            document.getElementById('editOrderIdHidden').value = order.id;
            document.getElementById('editPickupDate').value = order.pickupDate;
            document.getElementById('editPickupTime').value = order.pickupTime;
            document.getElementById('editTotalPrice').value = order.totalPrice;
            document.getElementById('editDepositAmount').value = order.depositAmount;
            document.getElementById('editStatusId').value = order.statusId;
            document.getElementById('editPaymentMethod').value = order.paymentMethod;
            document.getElementById('editNotes').value = order.notes || '';
            document.getElementById('editDecorationNotes').value = order.decorationNotes || '';
            
            openModal('editOrderModal');
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // SAVE ORDER EDITS (Update Operation)
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function saveOrderEdits(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const orderId = parseInt(formData.get('orderId'));
            
            const updates = {
                customerId: parseInt(formData.get('customerId')),
                productId: parseInt(formData.get('productId')),
                pickupDate: formData.get('pickupDate'),
                pickupTime: formData.get('pickupTime'),
                totalPrice: parseFloat(formData.get('totalPrice')),
                depositAmount: parseFloat(formData.get('depositAmount')),
                statusId: parseInt(formData.get('statusId')),
                paymentMethod: formData.get('paymentMethod'),
                notes: formData.get('notes'),
                decorationNotes: formData.get('decorationNotes')
            };
            
            const success = unifiedMockData.updateOrder(orderId, updates);
            
            if (success) {
                closeModal('editOrderModal');
                // Refresh the orders display
                allOrders = unifiedMockData.orders.map(order => {
                    const customer = unifiedMockData.customers.find(c => c.id === order.customerId);
                    const product = unifiedMockData.products.find(p => p.id === order.productId);
                    const status = unifiedMockData.orderStatuses.find(s => s.id === order.statusId);
                    
                    let statusText = 'pending';
                    if (order.statusId === 1) statusText = 'pending';
                    else if (order.statusId === 2) statusText = 'in-progress';
                    else if (order.statusId === 3) statusText = 'in-progress';
                    else if (order.statusId === 4) statusText = 'confirmed';
                    else if (order.statusId === 5) statusText = 'completed';
                    
                    return {
                        id: order.id,
                        customer: customer ? (customer.companyName || `${customer.firstName} ${customer.lastName}`) : 'Unknown',
                        phone: customer ? (customer.phone || customer.mobilePhone) : '',
                        date: order.orderDate,
                        pickupDate: order.pickupDate,
                        amount: order.totalPrice,
                        status: statusText,
                        statusDescription: status ? status.description : 'Unknown',
                        cake: product ? product.name : 'Unknown Product',
                        notes: order.notes || ''
                    };
                });
                filteredOrders = [...allOrders];
                loadOrders();
                showNotification('Order updated successfully!', 'success');
            } else {
                showNotification('Failed to update order', 'error');
            }
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // MARK ORDER INACTIVE (Soft Delete)
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function markOrderInactive(orderId) {
            currentOrderId = orderId;
            document.getElementById('inactiveOrderId').textContent = orderId;
            openModal('inactiveOrderModal');
        }

        function confirmMarkOrderInactive() {
            const success = unifiedMockData.cancelOrder(currentOrderId);
            
            if (success) {
                closeModal('inactiveOrderModal');
                // Refresh the orders display
                allOrders = unifiedMockData.orders.map(order => {
                    const customer = unifiedMockData.customers.find(c => c.id === order.customerId);
                    const product = unifiedMockData.products.find(p => p.id === order.productId);
                    const status = unifiedMockData.orderStatuses.find(s => s.id === order.statusId);
                    
                    let statusText = 'pending';
                    if (order.statusId === 1) statusText = 'pending';
                    else if (order.statusId === 2) statusText = 'in-progress';
                    else if (order.statusId === 3) statusText = 'in-progress';
                    else if (order.statusId === 4) statusText = 'confirmed';
                    else if (order.statusId === 5) statusText = 'completed';
                    
                    return {
                        id: order.id,
                        customer: customer ? (customer.companyName || `${customer.firstName} ${customer.lastName}`) : 'Unknown',
                        phone: customer ? (customer.phone || customer.mobilePhone) : '',
                        date: order.orderDate,
                        pickupDate: order.pickupDate,
                        amount: order.totalPrice,
                        status: statusText,
                        statusDescription: status ? status.description : 'Unknown',
                        cake: product ? product.name : 'Unknown Product',
                        notes: order.notes || ''
                    };
                });
                filteredOrders = [...allOrders];
                loadOrders();
                showNotification('Order cancelled successfully', 'warning');
            } else {
                showNotification('Failed to cancel order', 'error');
            }
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // HELPER FUNCTIONS
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }

        function formatDate(dateStr) {
            if (!dateStr) return 'N/A';
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        function formatTime(timeStr) {
            if (!timeStr) return 'N/A';
            const [hours, minutes] = timeStr.split(':');
            const hour = parseInt(hours);
            const ampm = hour >= 12 ? 'PM' : 'AM';
            const displayHour = hour % 12 || 12;
            return `${displayHour}:${minutes} ${ampm}`;
        }

        function getStatusClass(statusId) {
            const classes = {
                1: 'pending',
                2: 'baking',
                3: 'decorating',
                4: 'ready',
                5: 'completed'
            };
            return classes[statusId] || 'unknown';
        }

        function showNotification(message, type = 'info') {
            // Simple alert for now - can be replaced with toast notification
            alert(message);
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal-overlay')) {
                const modalId = event.target.id;
                closeModal(modalId);
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const openModals = document.querySelectorAll('.modal-overlay[style*="display: flex"]');
                openModals.forEach(modal => closeModal(modal.id));
            }
        });

        // Add event listeners
        document.getElementById('searchInput').addEventListener('input', filterOrders);
        document.getElementById('statusFilter').addEventListener('change', filterOrders);
        document.getElementById('dateFilter').addEventListener('change', filterOrders);

        // Initialize
        window.addEventListener('load', initializePage);
    </script>
</body>
</html>
