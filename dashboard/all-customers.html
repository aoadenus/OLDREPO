<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Customers - Emily Bakes Cakes</title>
    <link rel="stylesheet" href="css/dashboard-redesigned.css">
    <style>
        .filters-bar {
            background: var(--bg-white);
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .filter-group label {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-group select,
        .filter-group input {
            padding: 8px 12px;
            border: 1px solid var(--border-light);
            border-radius: 6px;
            font-size: 13px;
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(196, 69, 105, 0.1);
        }

        .customers-table-container {
            background: var(--bg-white);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
        }

        .customers-table {
            width: 100%;
            border-collapse: collapse;
        }

        .customers-table thead {
            background: var(--bg-light);
            border-bottom: 2px solid var(--border-light);
        }

        .customers-table th {
            padding: 12px 14px;
            text-align: left;
            font-weight: 600;
            font-size: 11px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .customers-table tbody tr {
            border-bottom: 1px solid var(--border-light);
            transition: var(--transition-fast);
        }

        .customers-table tbody tr:hover {
            background: var(--bg-light);
        }

        .customers-table td {
            padding: 12px 14px;
            font-size: 13px;
            color: var(--text-primary);
        }

        .customer-name {
            font-weight: 600;
            color: var(--primary);
        }

        .customer-email {
            color: var(--text-secondary);
            font-size: 12px;
        }

        .order-count {
            background: rgba(196, 69, 105, 0.1);
            color: var(--primary);
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 600;
            font-size: 12px;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .btn-sm {
            padding: 6px 10px;
            border: none;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-fast);
            text-decoration: none;
            display: inline-block;
        }

        .btn-view {
            background: var(--info);
            color: white;
        }

        .btn-view:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

        .btn-edit {
            background: var(--primary);
            color: white;
        }

        .btn-edit:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .btn-delete {
            background: var(--danger);
            color: white;
        }

        .btn-delete:hover {
            background: #dc2626;
            transform: translateY(-1px);
        }

        .empty-state {
            padding: 60px 20px;
            text-align: center;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-white);
            border-radius: 8px;
            padding: 32px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 25px rgba(0, 0, 0, 0.15);
        }

        .modal-header {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            font-size: 12px;
            color: var(--text-primary);
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-light);
            border-radius: 6px;
            font-size: 13px;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(196, 69, 105, 0.1);
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .modal-actions button {
            flex: 1;
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--border-light);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--border-dark);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--bg-white);
            padding: 16px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--border-light);
            box-shadow: var(--shadow-sm);
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 11px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .add-btn {
            background: var(--primary);
            color: white;
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: var(--transition-fast);
            margin-bottom: 20px;
        }

        .add-btn:hover {
            background: var(--primary-dark);
        }

        @media (max-width: 768px) {
            .filters-bar {
                grid-template-columns: 1fr;
            }

            .customers-table {
                font-size: 11px;
            }

            .customers-table th,
            .customers-table td {
                padding: 8px 10px;
            }

            .action-buttons {
                flex-direction: column;
            }

            .btn-sm {
                width: 100%;
            }

            .modal-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <header class="header">
        <div class="header-left">
            <div class="header-logo">
                <div class="logo-text">Emily Bakes Cakes</div>
            </div>
        </div>
        <div class="header-right">
            <button class="header-btn" onclick="backToSite()">‚Üê Back to Site</button>
            <button class="logout-btn header-btn" onclick="handleLogout()">Logout</button>
        </div>
    </header>

    <!-- LEFT NAVIGATION -->
    <nav class="nav-sidebar">
        <ul>
            <li><a href="#" onclick="goToDashboard(); return false;" class="nav-link">Dashboard</a></li>
            <li><a href="all-orders.html" class="nav-link">View Orders</a></li>
            <li><a href="all-customers.html" class="nav-link active">View Customers</a></li>
            <li><a href="view-products.html" class="nav-link">View Products</a></li>
            <li><a href="reports.html" class="nav-link">Reports</a></li>
        </ul>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="main-content">
        <div class="content">
            <!-- PAGE HEADER -->
            <div class="page-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                <div>
                    <h1 class="page-title">All Customers</h1>
                    <p class="page-subtitle">Manage customer information and history</p>
                </div>
                <a href="new-customer.html" class="action-btn-large" style="text-decoration: none;">+ Create New Customer</a>
            </div>

            <!-- FILTERS -->
            <div class="filters-bar">
                <div class="filter-group">
                    <label>Search by Name or Phone</label>
                    <input type="text" id="searchInput" placeholder="Search...">
                </div>
                <div class="filter-group">
                    <label>Customer Type</label>
                    <select id="typeFilter">
                        <option value="">All Types</option>
                        <option value="repeat">Repeat Customer</option>
                        <option value="new">New Customer</option>
                    </select>
                </div>
                <div class="filter-group" style="align-self: flex-end;">
                    <button class="action-btn-primary" onclick="resetFilters()">Reset Filters</button>
                </div>
            </div>

            <!-- CUSTOMERS TABLE -->
            <div class="customers-table-container">
                <table class="customers-table" id="customersTable">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Phone</th>
                            <th>Orders</th>
                            <th>Join Date</th>
                            <th>Type</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="customersTableBody">
                        <tr>
                            <td colspan="7" class="empty-state">
                                <div class="empty-state-icon">üë•</div>
                                <p>No customers found</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- VIEW CUSTOMER MODAL (Read-Only) -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="viewCustomerModal" class="modal-overlay">
        <div class="modal-container modal-large">
            <div class="modal-header">
                <h2 class="modal-title">Customer Details - <span id="viewCustomerName"></span></h2>
                <button class="modal-close-btn" onclick="closeModal('viewCustomerModal')" aria-label="Close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div id="viewCustomerBody" class="customer-details-grid">
                    <!-- Dynamically populated -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('viewCustomerModal')">Close</button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- EDIT CUSTOMER MODAL (Editable Form) -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="editCustomerModal" class="modal-overlay">
        <div class="modal-container modal-large">
            <div class="modal-header">
                <h2 class="modal-title">Edit Customer - ID: <span id="editCustomerId"></span></h2>
                <button class="modal-close-btn" onclick="closeModal('editCustomerModal')" aria-label="Close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <form id="editCustomerForm" onsubmit="saveCustomerEdits(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="editFirstName">First Name *</label>
                            <input type="text" id="editFirstName" name="firstName" required class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="editLastName">Last Name *</label>
                            <input type="text" id="editLastName" name="lastName" required class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="editMiddleInitial">Middle Initial</label>
                            <input type="text" id="editMiddleInitial" name="middleInitial" maxlength="1" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="editTypeId">Customer Type *</label>
                            <select id="editTypeId" name="typeId" required class="form-control" onchange="toggleCompanyField()">
                                <option value="1">Individual</option>
                                <option value="2">Business</option>
                            </select>
                        </div>
                        <div class="form-group full-width" id="companyNameGroup" style="display: none;">
                            <label for="editCompanyName">Company Name</label>
                            <input type="text" id="editCompanyName" name="companyName" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="editEmail">Email</label>
                            <input type="email" id="editEmail" name="email" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="editMobilePhone">Mobile Phone *</label>
                            <input type="tel" id="editMobilePhone" name="mobilePhone" required class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="editWorkPhone">Work Phone</label>
                            <input type="tel" id="editWorkPhone" name="workPhone" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="editHomePhone">Home Phone</label>
                            <input type="tel" id="editHomePhone" name="homePhone" class="form-control">
                        </div>
                        <div class="form-group full-width">
                            <label for="editAddressLine1">Address Line 1</label>
                            <input type="text" id="editAddressLine1" name="addressLine1" class="form-control">
                        </div>
                        <div class="form-group full-width">
                            <label for="editAddressLine2">Address Line 2</label>
                            <input type="text" id="editAddressLine2" name="addressLine2" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="editZipCode">Zip Code</label>
                            <input type="text" id="editZipCode" name="zipCode" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="editStatusId">Status *</label>
                            <select id="editStatusId" name="statusId" required class="form-control">
                                <option value="1">Active</option>
                                <option value="2">Inactive</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="editIsPreferred">Preferred Customer</label>
                            <select id="editIsPreferred" name="isPreferred" class="form-control">
                                <option value="N">No</option>
                                <option value="Y">Yes</option>
                            </select>
                        </div>
                    </div>
                    <input type="hidden" id="editCustomerIdHidden" name="customerId">
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeModal('editCustomerModal')">Cancel</button>
                <button type="button" class="btn-primary" onclick="document.getElementById('editCustomerForm').requestSubmit()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- MARK CUSTOMER INACTIVE MODAL (Confirmation) -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="inactiveCustomerModal" class="modal-overlay">
        <div class="modal-container modal-small">
            <div class="modal-header">
                <h2 class="modal-title">Mark Customer Inactive?</h2>
                <button class="modal-close-btn" onclick="closeModal('inactiveCustomerModal')" aria-label="Close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="warning-banner">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                        <line x1="12" y1="9" x2="12" y2="13"></line>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg>
                    <div>
                        <p class="warning-title">Are you sure you want to mark <strong id="inactiveCustomerName"></strong> as inactive?</p>
                        <p class="warning-subtitle">This action will mark the customer as inactive in the system.</p>
                    </div>
                </div>
                <div class="info-box">
                    <h4>What happens when you mark as inactive:</h4>
                    <ul>
                        <li>Customer status changes to "Inactive"</li>
                        <li>Customer remains in system for records</li>
                        <li>Can be reactivated by editing the customer</li>
                        <li>Past orders remain visible</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('inactiveCustomerModal')">No, Keep Active</button>
                <button class="btn-warning" onclick="confirmMarkCustomerInactive()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="15" y1="9" x2="9" y2="15"></line>
                        <line x1="9" y1="9" x2="15" y2="15"></line>
                    </svg>
                    Yes, Mark Inactive
                </button>
            </div>
        </div>
    </div>

    <script src="js/main.js"></script>
    <script src="js/unified-mock-data.js"></script>
    <script>
        // Load all customers from unified mock data
        let allCustomers = unifiedMockData.customers.map(customer => {
            const customerOrders = unifiedMockData.orders.filter(o => o.customerId === customer.id);
            const customerType = unifiedMockData.customerTypes.find(t => t.id === customer.typeId);
            
            return {
                id: customer.id,
                name: customer.companyName || `${customer.firstName} ${customer.lastName}`,
                email: customer.email,
                phone: customer.phone || customer.mobilePhone,
                address: customer.addressLine1 + (customer.addressLine2 ? `, ${customer.addressLine2}` : ''),
                joinDate: customerOrders.length > 0 ? customerOrders.sort((a, b) => new Date(a.orderDate) - new Date(b.orderDate))[0].orderDate : '2025-01-01',
                orders: customerOrders.length,
                type: customer.isPreferred === 'Y' ? 'repeat' : 'new',
                customerType: customerType ? customerType.description : 'Unknown',
                customerTypeShort: customer.typeId === 2 ? 'Corporate' : 'Retail'
            };
        });

        let filteredCustomers = [...allCustomers];
        let currentEditCustomerId = null;
        let nextCustomerId = unifiedMockData.customers.length + 1;

        function initializePage() {
            loadCustomers();
        }

        function loadCustomers() {
            const tbody = document.getElementById('customersTableBody');
            
            if (filteredCustomers.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="empty-state"><div class="empty-state-icon">üë•</div><p>No customers found</p></td></tr>';
                return;
            }

            tbody.innerHTML = filteredCustomers.map(customer => `
                <tr>
                    <td class="customer-name">${customer.name}</td>
                    <td>${customer.email}</td>
                    <td>${customer.phone}</td>
                    <td><span class="order-count">${customer.orders} orders</span></td>
                    <td>${new Date(customer.joinDate).toLocaleDateString()}</td>
                    <td><span class="customer-type-badge ${customer.customerTypeShort.toLowerCase()}">${customer.customerTypeShort}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-action btn-view" onclick="viewCustomer(${customer.id})" title="View Details">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                                View
                            </button>
                            <button class="btn-action btn-edit" onclick="editCustomer(${customer.id})" title="Edit Customer">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                </svg>
                                Edit
                            </button>
                            <button class="btn-action btn-inactive" onclick="markCustomerInactive(${customer.id})" title="Mark Inactive">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="15" y1="9" x2="9" y2="15"></line>
                                    <line x1="9" y1="9" x2="15" y2="15"></line>
                                </svg>
                                Inactive
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }


        function filterCustomers() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            const type = document.getElementById('typeFilter').value;

            filteredCustomers = allCustomers.filter(customer => {
                const matchesSearch = customer.name.toLowerCase().includes(search) || 
                                     customer.phone.includes(search);
                const matchesType = !type || customer.type === type;

                return matchesSearch && matchesType;
            });

            loadCustomers();
        }

        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('typeFilter').value = '';
            filteredCustomers = [...allCustomers];
            loadCustomers();
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // CRUD OPERATIONS FOR CUSTOMERS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        let currentCustomerId = null;

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // VIEW CUSTOMER (Read-Only Display)
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function viewCustomer(customerId) {
            const customer = unifiedMockData.customers.find(c => c.id === customerId);
            if (!customer) {
                showNotification('Customer not found', 'error');
                return;
            }
            
            const customerType = unifiedMockData.customerTypes.find(t => t.id === customer.typeId);
            const customerStatus = customer.statusId === 1 ? 'Active' : 'Inactive';
            const customerOrders = unifiedMockData.orders.filter(o => o.customerId === customer.id);
            
            document.getElementById('viewCustomerName').textContent = customer.companyName || `${customer.firstName} ${customer.lastName}`;
            document.getElementById('viewCustomerBody').innerHTML = `
                <div class="detail-card">
                    <h3 class="detail-card-title">Personal Information</h3>
                    <div class="detail-row">
                        <span class="detail-label">Full Name:</span>
                        <span class="detail-value">${customer.firstName} ${customer.middleInitial || ''} ${customer.lastName}</span>
                    </div>
                    ${customer.companyName ? `
                    <div class="detail-row">
                        <span class="detail-label">Company:</span>
                        <span class="detail-value">${customer.companyName}</span>
                    </div>
                    ` : ''}
                    <div class="detail-row">
                        <span class="detail-label">Customer Type:</span>
                        <span class="detail-value">${customerType ? customerType.description : 'Unknown'}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Status:</span>
                        <span class="status-badge ${customer.statusId === 1 ? 'status-ready' : 'status-pending'}">${customerStatus}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Preferred:</span>
                        <span class="detail-value">${customer.isPreferred === 'Y' ? '‚≠ê Yes' : 'No'}</span>
                    </div>
                </div>
                
                <div class="detail-card">
                    <h3 class="detail-card-title">Contact Information</h3>
                    <div class="detail-row">
                        <span class="detail-label">Email:</span>
                        <span class="detail-value">${customer.email || 'N/A'}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Mobile Phone:</span>
                        <span class="detail-value">${customer.mobilePhone}</span>
                    </div>
                    ${customer.workPhone ? `
                    <div class="detail-row">
                        <span class="detail-label">Work Phone:</span>
                        <span class="detail-value">${customer.workPhone}</span>
                    </div>
                    ` : ''}
                    ${customer.homePhone ? `
                    <div class="detail-row">
                        <span class="detail-label">Home Phone:</span>
                        <span class="detail-value">${customer.homePhone}</span>
                    </div>
                    ` : ''}
                </div>
                
                <div class="detail-card">
                    <h3 class="detail-card-title">Address</h3>
                    <div class="detail-row">
                        <span class="detail-label">Street:</span>
                        <span class="detail-value">${customer.addressLine1 || 'N/A'}</span>
                    </div>
                    ${customer.addressLine2 ? `
                    <div class="detail-row">
                        <span class="detail-label">Line 2:</span>
                        <span class="detail-value">${customer.addressLine2}</span>
                    </div>
                    ` : ''}
                    <div class="detail-row">
                        <span class="detail-label">Zip Code:</span>
                        <span class="detail-value">${customer.zipCode || 'N/A'}</span>
                    </div>
                </div>
                
                <div class="detail-card">
                    <h3 class="detail-card-title">Order History</h3>
                    <div class="detail-row">
                        <span class="detail-label">Total Orders:</span>
                        <span class="detail-value balance-due">${customerOrders.length}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Total Spent:</span>
                        <span class="detail-value">$${customerOrders.reduce((sum, o) => sum + o.totalPrice, 0).toFixed(2)}</span>
                    </div>
                </div>
            `;
            
            openModal('viewCustomerModal');
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // EDIT CUSTOMER (Populate Form)
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function editCustomer(customerId) {
            const customer = unifiedMockData.customers.find(c => c.id === customerId);
            if (!customer) {
                showNotification('Customer not found', 'error');
                return;
            }
            
            currentCustomerId = customerId;
            
            // Populate form fields
            document.getElementById('editCustomerId').textContent = customer.id;
            document.getElementById('editCustomerIdHidden').value = customer.id;
            document.getElementById('editFirstName').value = customer.firstName;
            document.getElementById('editLastName').value = customer.lastName;
            document.getElementById('editMiddleInitial').value = customer.middleInitial || '';
            document.getElementById('editTypeId').value = customer.typeId;
            document.getElementById('editCompanyName').value = customer.companyName || '';
            document.getElementById('editEmail').value = customer.email || '';
            document.getElementById('editMobilePhone').value = customer.mobilePhone;
            document.getElementById('editWorkPhone').value = customer.workPhone || '';
            document.getElementById('editHomePhone').value = customer.homePhone || '';
            document.getElementById('editAddressLine1').value = customer.addressLine1 || '';
            document.getElementById('editAddressLine2').value = customer.addressLine2 || '';
            document.getElementById('editZipCode').value = customer.zipCode || '';
            document.getElementById('editStatusId').value = customer.statusId;
            document.getElementById('editIsPreferred').value = customer.isPreferred;
            
            // Show/hide company field based on type
            toggleCompanyField();
            
            openModal('editCustomerModal');
        }

        // Toggle company name field visibility
        function toggleCompanyField() {
            const typeId = parseInt(document.getElementById('editTypeId').value);
            const companyGroup = document.getElementById('companyNameGroup');
            companyGroup.style.display = typeId === 2 ? 'block' : 'none';
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // SAVE CUSTOMER EDITS (Update Operation)
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function saveCustomerEdits(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const customerId = parseInt(formData.get('customerId'));
            
            const updates = {
                firstName: formData.get('firstName'),
                lastName: formData.get('lastName'),
                middleInitial: formData.get('middleInitial') || null,
                typeId: parseInt(formData.get('typeId')),
                companyName: formData.get('companyName') || null,
                email: formData.get('email') || null,
                mobilePhone: formData.get('mobilePhone'),
                workPhone: formData.get('workPhone') || null,
                homePhone: formData.get('homePhone') || null,
                addressLine1: formData.get('addressLine1') || null,
                addressLine2: formData.get('addressLine2') || null,
                zipCode: formData.get('zipCode') || null,
                statusId: parseInt(formData.get('statusId')),
                isPreferred: formData.get('isPreferred')
            };
            
            const success = unifiedMockData.updateCustomer(customerId, updates);
            
            if (success) {
                closeModal('editCustomerModal');
                // Refresh the customers display
                allCustomers = unifiedMockData.customers.map(customer => {
                    const customerOrders = unifiedMockData.orders.filter(o => o.customerId === customer.id);
                    const customerType = unifiedMockData.customerTypes.find(t => t.id === customer.typeId);
                    
                    return {
                        id: customer.id,
                        name: customer.companyName || `${customer.firstName} ${customer.lastName}`,
                        email: customer.email,
                        phone: customer.phone || customer.mobilePhone,
                        address: customer.addressLine1 + (customer.addressLine2 ? `, ${customer.addressLine2}` : ''),
                        joinDate: customerOrders.length > 0 ? customerOrders.sort((a, b) => new Date(a.orderDate) - new Date(b.orderDate))[0].orderDate : '2025-01-01',
                        orders: customerOrders.length,
                        type: customer.isPreferred === 'Y' ? 'repeat' : 'new',
                        customerType: customerType ? customerType.description : 'Unknown',
                        customerTypeShort: customer.typeId === 2 ? 'Corporate' : 'Retail'
                    };
                });
                filteredCustomers = [...allCustomers];
                loadCustomers();
                showNotification('Customer updated successfully!', 'success');
            } else {
                showNotification('Failed to update customer', 'error');
            }
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // MARK CUSTOMER INACTIVE (Soft Delete)
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function markCustomerInactive(customerId) {
            const customer = unifiedMockData.customers.find(c => c.id === customerId);
            if (!customer) return;
            
            currentCustomerId = customerId;
            const customerName = customer.companyName || `${customer.firstName} ${customer.lastName}`;
            document.getElementById('inactiveCustomerName').textContent = customerName;
            openModal('inactiveCustomerModal');
        }

        function confirmMarkCustomerInactive() {
            const success = unifiedMockData.updateCustomer(currentCustomerId, { statusId: 2 });
            
            if (success) {
                closeModal('inactiveCustomerModal');
                // Refresh the customers display
                allCustomers = unifiedMockData.customers.map(customer => {
                    const customerOrders = unifiedMockData.orders.filter(o => o.customerId === customer.id);
                    const customerType = unifiedMockData.customerTypes.find(t => t.id === customer.typeId);
                    
                    return {
                        id: customer.id,
                        name: customer.companyName || `${customer.firstName} ${customer.lastName}`,
                        email: customer.email,
                        phone: customer.phone || customer.mobilePhone,
                        address: customer.addressLine1 + (customer.addressLine2 ? `, ${customer.addressLine2}` : ''),
                        joinDate: customerOrders.length > 0 ? customerOrders.sort((a, b) => new Date(a.orderDate) - new Date(b.orderDate))[0].orderDate : '2025-01-01',
                        orders: customerOrders.length,
                        type: customer.isPreferred === 'Y' ? 'repeat' : 'new',
                        customerType: customerType ? customerType.description : 'Unknown',
                        customerTypeShort: customer.typeId === 2 ? 'Corporate' : 'Retail'
                    };
                });
                filteredCustomers = [...allCustomers];
                loadCustomers();
                showNotification('Customer marked as inactive', 'warning');
            } else {
                showNotification('Failed to update customer status', 'error');
            }
        }

        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // HELPER FUNCTIONS
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }

        function showNotification(message, type = 'info') {
            // Simple alert for now - can be replaced with toast notification
            alert(message);
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal-overlay')) {
                const modalId = event.target.id;
                closeModal(modalId);
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const openModals = document.querySelectorAll('.modal-overlay[style*="display: flex"]');
                openModals.forEach(modal => closeModal(modal.id));
            }
        });

        // Add event listeners
        document.getElementById('searchInput').addEventListener('input', filterCustomers);
        document.getElementById('typeFilter').addEventListener('change', filterCustomers);

        // Initialize
        window.addEventListener('load', initializePage);
    </script>
</body>
</html>
